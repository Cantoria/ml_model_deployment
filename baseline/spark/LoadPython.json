{"paragraphs":[{"text":"%pyspark\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml import PipelineModel\n\nfrom pyspark import SparkFiles\n\nurl = \"https://s3-us-west-2.amazonaws.com/mlapi-samples/demo/data/input/iris.csv\"\nspark.sparkContext.addFile(url)\n\n# Load and parse the data file, converting it to a DataFrame.\ndata = spark.read.csv(SparkFiles.get(\"iris.csv\"), header=True)\n\ndata = data.withColumn(\"sepal_length\", data[\"sepal_length\"].cast(DoubleType()))\ndata = data.withColumn(\"sepal_width\", data[\"sepal_width\"].cast(DoubleType()))\ndata = data.withColumn(\"petal_width\", data[\"petal_width\"].cast(DoubleType()))\ndata = data.withColumn(\"petal_length\", data[\"petal_length\"].cast(DoubleType()))\n\nfilebase=\"hdfs://ad95fe885c37011e8aee806444a30499-1181034928.us-west-2.elb.amazonaws.com:9000/tmp/\"\n\npipeline = Pipeline.read().load(\"{}/classification-pipeline\".format(filebase))\nmodel = PipelineModel.read().load(\"{}/classification-model\".format(filebase))\n\n# Make predictions.\npredictions = model.transform(data)\n\n# Select example rows to display.\npredictions.select(\"predictedLabel\", \"species\", \"features\").show(5)\n\n# Select (prediction, true label) and compute test error\nevaluator = MulticlassClassificationEvaluator(\n    labelCol=\"indexedLabel\", predictionCol=\"prediction\", metricName=\"accuracy\")\naccuracy = evaluator.evaluate(predictions)\nprint(\"Test Error = %g\" % (1.0 - accuracy))\n","dateUpdated":"2018-10-02T20:03:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+-----------+-----------------+\n|predictedLabel|    species|         features|\n+--------------+-----------+-----------------+\n|   Iris Setosa|Iris Setosa|[5.1,3.5,0.2,1.4]|\n|   Iris Setosa|Iris Setosa|[4.9,3.0,0.2,1.4]|\n|   Iris Setosa|Iris Setosa|[4.7,3.2,0.2,1.3]|\n|   Iris Setosa|Iris Setosa|[4.6,3.1,0.2,1.5]|\n|   Iris Setosa|Iris Setosa|[5.0,3.6,0.2,1.4]|\n+--------------+-----------+-----------------+\nonly showing top 5 rows\n\nTest Error = 0.0133333\n"}]},"apps":[],"jobName":"paragraph_1538510576041_-1990641433","id":"20180928-225357_691808804","dateCreated":"2018-10-02T20:02:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:286","user":"anonymous","dateFinished":"2018-10-02T20:03:06+0000","dateStarted":"2018-10-02T20:03:02+0000"},{"text":"%pyspark\nfrom pyspark.sql.types import DoubleType,StructType\nfrom pyspark.sql import SparkSession\n\nspark = SparkSession.builder.master(\"spark-master\").getOrCreate()\ncSchema = StructType([StructField(\"sepal_length\", DoubleType()),StructField(\"sepal_width\", DoubleType()),StructField(\"petal_width\", DoubleType()) ,StructField(\"petal_length\", DoubleType())])\n\n# notice extra square brackets around each element of list \ntest_list =[[5.9, 3.0, 5.1, 1.8]]\n\ndf = spark.createDataFrame(test_list,schema=cSchema) \ndf.show()\npredictions = model.transform(df)\npredictions.show()\n","dateUpdated":"2018-10-02T20:19:04+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538510576042_-1989487186","id":"20180928-225442_870951873","dateCreated":"2018-10-02T20:02:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:287","user":"anonymous","dateFinished":"2018-10-02T20:19:04+0000","dateStarted":"2018-10-02T20:19:04+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----------+-----------+------------+\n|sepal_length|sepal_width|petal_width|petal_length|\n+------------+-----------+-----------+------------+\n|         5.9|        3.0|        5.1|         1.8|\n+------------+-----------+-----------+------------+\n\n+------------+-----------+-----------+------------+-----------------+-----------------+-------------+-------------+----------+--------------+\n|sepal_length|sepal_width|petal_width|petal_length|         features|  indexedFeatures|rawPrediction|  probability|prediction|predictedLabel|\n+------------+-----------+-----------+------------+-----------------+-----------------+-------------+-------------+----------+--------------+\n|         5.9|        3.0|        5.1|         1.8|[5.9,3.0,5.1,1.8]|[5.9,3.0,5.1,1.8]|[2.0,4.0,4.0]|[0.2,0.4,0.4]|       1.0|   Iris Setosa|\n+------------+-----------+-----------+------------+-----------------+-----------------+-------------+-------------+----------+--------------+\n\n"}]}},{"text":"%pyspark\nprint spark","user":"anonymous","dateUpdated":"2018-10-02T20:14:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538510772801_285657298","id":"20181002-200612_1815072737","dateCreated":"2018-10-02T20:06:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:457","dateFinished":"2018-10-02T20:14:10+0000","dateStarted":"2018-10-02T20:14:10+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.session.SparkSession object at 0x7f71e4f18b10>\n"}]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-10-02T20:14:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1538511250476_1861292700","id":"20181002-201410_13503750","dateCreated":"2018-10-02T20:14:10+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:676"}],"name":"LoadPython","id":"2DUKPWKDV","angularObjects":{"2DU271S2M:shared_process":[],"2DT7QKZ5U:shared_process":[],"2DU58SXMJ:shared_process":[],"2DRY1PBFX:shared_process":[],"2DRECSPVX:shared_process":[],"2DRE4FJQC:shared_process":[],"2DU4BHYNW:shared_process":[],"2DS8DY9ZK:shared_process":[],"2DREZJUM6:shared_process":[],"2DTTF4DMX:shared_process":[],"2DU4A2EHT:shared_process":[],"2DSW9ZAU2:shared_process":[],"2DR8B3WB4:shared_process":[],"2DUKMFE6M:shared_process":[],"2DRRQ18HA:shared_process":[],"2DRDKYCUF:shared_process":[],"2DUBSVM1F:shared_process":[],"2DTKG1Q7B:shared_process":[],"2DSGP3JXS:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}